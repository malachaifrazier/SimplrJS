// simplr v2.0.0
(function(e){Array.prototype.remove=function(a,b){var c=this.slice((b||a)+1||this.length);this.length=a<0?this.length+a:a;return this.push.apply(this,c)};window.Simplr={Config:{Data:{ConsoleActive:!1},mToggleConsole:function(a){e("#_simplr_core_console").remove();Simplr.Config.Data.ConsoleActive=!1;if(a)try{if(typeof window.console!="undefined"&&typeof window.console.group!="undefined")e(function(){e("body").append('<p id="_simplr_core_console" style="margin: 0; text-align: center; position: fixed; top: 0; width: 100%; left: 0; border-bottom: 1px solid #000; color: #fff; font-weight: bold; background-color: #f00; padding: 5px; font-size: 11px; opacity: .75;">[console]: Console Messaging Active</p>'); e("#_simplr_core_console").mouseover(function(){e(this).slideUp()}).mouseout(function(){e(this).delay(3E3).slideDown()})}),Simplr.Config.Data.ConsoleActive=!0}catch(b){}return Simplr.Config.Data.ConsoleActive}}};Simplr.Browser={};(function(){var a={UserAgent:""};Simplr.Browser={mAddressBarHeight:function(){var a=Simplr.Browser.mDevice();return a=="iPhone"||a=="iPod"||a=="iPad"?60:0},mDevice:function(){if(a.UserAgent.match(/iPhone/i))return"iPhone";else if(a.UserAgent.match(/iPod/i))return"iPod";else if(a.UserAgent.match(/iPad/i))return"iPad"; else if(a.UserAgent.match(/Android/i))return"Android";return"other"},mLocalStorageCapable:function(){return Simplr.Core.Util.mHasLocalStorage()},mSetUserAgent:function(b){a.UserAgent=b},mTouchCapable:function(){var a=Simplr.Browser.mDevice();return a=="iPhone"||a=="iPod"||a=="iPad"||a=="Android"}};Simplr.Browser.mSetUserAgent(navigator.userAgent)})();Simplr.Cache={};(function(){Simplr.Cache={mExpire:function(a){Simplr.Core.Util.mHasLocalStorage()&&(localStorage.removeItem(a),localStorage.removeItem(a+ "_data"));return null},mGet:function(a){a=e.extend({key:"",identifier:""},a);if(Simplr.Core.Util.mHasLocalStorage()&&a.key!=""){var b=localStorage.getItem(a.key);if(b!=null&&(b=b.split("|"),b.length==2&&b[0]==a.identifier))if((new Date).getTime()<=parseInt(b[1],10))return localStorage.getItem(a.key+"_data");else Simplr.Cache.mExpire(a.key)}return null},mSet:function(a){a=e.extend({key:"",identifier:"",data:"",freshness:6E5},a);Simplr.Core.Util.mHasLocalStorage()&&a.key!=""&&(localStorage.setItem(a.key, a.identifier+"|"+((new Date).getTime()+a.freshness)),localStorage.setItem(a.key+"_data",a.data));return a.data}}})();Simplr.Controller={};(function(a,b,c){function f(a){a=a||location.href;return"#"+a.replace(/^[^#]*#?(.*)$/,"$1")}var d="hashchange",g=document,e,i=a.event.special,j=g.documentMode,l="on"+d in b&&(j===c||j>7);a.fn[d]=function(a){return a?this.bind(d,a):this.trigger(d)};a.fn[d].delay=50;i[d]=a.extend(i[d],{setup:function(){if(l)return!1;a(e.start)},teardown:function(){if(l)return!1;a(e.stop)}}); e=function(){function e(){var c=f(),g=n(i);if(c!==i)p(i=c,g),a(b).trigger(d);else if(g!==i)location.href=location.href.replace(/#.*/,"")+g;j=setTimeout(e,a.fn[d].delay)}var h={},j,i=f(),q=function(a){return a},p=q,n=q;h.start=function(){j||e()};h.stop=function(){j&&clearTimeout(j);j=c};a.browser.msie&&!l&&function(){var c,b;h.start=function(){if(!c)b=(b=a.fn[d].src)&&b+f(),c=a('<iframe tabindex="-1" title="empty"/>').hide().one("load",function(){b||p(f());e()}).attr("src",b||"javascript:0").insertAfter("body")[0].contentWindow, g.onpropertychange=function(){try{if(event.propertyName==="title")c.document.title=g.title}catch(a){}}};h.stop=q;n=function(){return f(c.location.href)};p=function(f,b){var e=c.document,h=a.fn[d].domain;if(f!==b)e.title=g.title,e.open(),h&&e.write('<script>document.domain="'+h+'"<\/script>'),e.close(),c.location.hash=f}}();return h}()})(jQuery,this);(function(){function a(a){return a.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}var b={CRUD:{view:!0,"new":!0,update:!0,"delete":!0}, Commands:{},Bases:{}};Simplr.Controller={mAddBases:function(a){for(var a=e.isArray(a)?a:[a],f=0,d=a.length;f<d;f++)b.Bases[a[f]]=1},mAddCommands:function(a){for(var f in a){var d=e.extend({route:[],callback:function(){}},a[f]),g=d.route.join("_");if(g!="")b.Commands[g]=d.callback}},mData:function(){return b},mExecute:function(a){var f=a.route.join("_");try{b.Commands[f](a)}catch(d){}},mRoute:function(c){c={route:[],url:c,base:"",resources:{},action:"",parameters:{}};if(c.url[0]=="#")c.url=c.url.substring(1); if(c.url[0]=="!")c.url=c.url.substring(1);var f=c.url.split("?"),d=decodeURI(f[0]),g;for(g in b.Bases)if((f[0]=f[0].replace(g,""))!=d){c.base=g;c.route.push(g);break}f[0]=f[0].split("/");c.action=f[0][f[0].length-1];c.action=b.CRUD[c.action]?c.action:"view";g=!0;for(var d="",h=0,i=f[0].length-1;h<i;h++)f[0][h]!=""&&(g?(d=f[0][h],c.route.push(d),c.resources[d]=""):c.resources[d]=f[0][h],g=!g);if(f[1]){f=f[1].split("&");g=0;for(d=f.length;g<d;g++)h=f[g].split("="),c.parameters[h[0]]=e.trim(a(decodeURIComponent(h[1])))}c.route.push(c.action); return c},mRouteAndExecute:function(a){Simplr.Controller.mExecute(Simplr.Controller.mRoute(a))}};e(function(){e(window).hashchange(function(){var a=window.location.href.split("#");a.length<2&&(Simplr.Core.Util.mEmpty(a[1])||Simplr.Controller.mRouteAndExecute(a[1]))})})})();Simplr.Conversion={};var m;m||(m={});(function(){function a(a){return a<10?"0"+a:a}function b(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var f=i[a];return typeof f==="string"?f:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+ '"':'"'+a+'"'}function c(a,f){var d,i,o,q,p=g,n,k=f[a];k&&typeof k==="object"&&typeof k.toJSON==="function"&&(k=k.toJSON(a));typeof j==="function"&&(k=j.call(f,a,k));switch(typeof k){case "string":return b(k);case "number":return isFinite(k)?String(k):"null";case "boolean":case "null":return String(k);case "object":if(!k)return"null";g+=e;n=[];if(Object.prototype.toString.apply(k)==="[object Array]"){q=k.length;for(d=0;d<q;d+=1)n[d]=c(d,k)||"null";o=n.length===0?"[]":g?"[\n"+g+n.join(",\n"+g)+"\n"+ p+"]":"["+n.join(",")+"]";g=p;return o}if(j&&typeof j==="object"){q=j.length;for(d=0;d<q;d+=1)typeof j[d]==="string"&&(i=j[d],(o=c(i,k))&&n.push(b(i)+(g?": ":":")+o))}else for(i in k)Object.prototype.hasOwnProperty.call(k,i)&&(o=c(i,k))&&n.push(b(i)+(g?": ":":")+o);o=n.length===0?"{}":g?"{\n"+g+n.join(",\n"+g)+"\n"+p+"}":"{"+n.join(",")+"}";g=p;return o}}if(typeof Date.prototype.toJSON!=="function")Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+ 1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()};var f=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,g,e,i={"\u0008":"\\b","\t":"\\t","\n":"\\n", "\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},j;if(typeof m.stringify!=="function")m.stringify=function(a,f,d){var b;e=g="";if(typeof d==="number")for(b=0;b<d;b+=1)e+=" ";else typeof d==="string"&&(e=d);if((j=f)&&typeof f!=="function"&&(typeof f!=="object"||typeof f.length!=="number"))throw Error("JSON.stringify");return c("",{"":a})};if(typeof m.parse!=="function")m.parse=function(a,d){function c(a,f){var b,e,g=a[f];if(g&&typeof g==="object")for(b in g)Object.prototype.hasOwnProperty.call(g,b)&& (e=c(g,b),e!==void 0?g[b]=e:delete g[b]);return d.call(a,f,g)}var b,a=String(a);f.lastIndex=0;f.test(a)&&(a=a.replace(f,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return b=eval("("+a+")"),typeof d==="function"?c({"":b},""):b;throw new SyntaxError("JSON.parse");}})();Simplr.Conversion= {mObjectToJSONString:function(a,b,c){return m.stringify(a,b,c)},mJSONStringToObject:function(a,b){return m.parse(a,b)}};Simplr.Cookie={};Simplr.Cookie={mGet:function(a){a=e.extend({name:""},a);if(document.cookie.length>0&&!Simplr.Core.Util.mEmpty(a.name)&&(a=document.cookie.match("(^|;) ?"+a.name+"=([^;]*)(;|$)")))return decodeURIComponent(a[2]);return null},mSet:function(a){a=e.extend({name:"",value:"",expireDays:null,path:"/",domain:null,secure:!1},a);if(!Simplr.Core.Util.mEmpty(a.name)){var b= a.name+"="+encodeURIComponent(a.value);if(!Simplr.Core.Util.mEmpty(a.expireDays)){var c=new Date;c.setTime(c.getTime()+a.expireDays*864E5);b+="; expires="+c.toUTCString()}b+=!Simplr.Core.Util.mEmpty(a.path)?"; path="+a.path:"";b+=!Simplr.Core.Util.mEmpty(a.domain)?"; domain="+a.domain:"";b+=a.secure?"; secure":"";document.cookie=b;return!0}return!1},mExpire:function(a){return Simplr.Cookie.mSet(e.extend({name:"",expireDays:-1},a))}};Simplr.Core={};(function(){function a(b){if(e.isArray(b.message)){console.group(b.group); for(var c=0,f=b.message.length;c<f;c++){var d=e.extend(Simplr.Core.Console.mGetMessageTemplate(),b.message[c]);a(d)}}else console.group(b.message),console.log(b.data);console.groupEnd()}Simplr.Core.Console={mGetMessageTemplate:function(){return{group:"",message:"",data:""}},mMessage:function(b){Simplr.Config.Data.ConsoleActive&&(b=e.extend(Simplr.Core.Console.mGetMessageTemplate(),b),a(b))}}})();(function(){function a(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g, "&quot;")}function b(a,d){if(typeof a==typeof d){if(typeof a=="object"){if(e.isArray(a)){if(a.length==d.length){for(var c=0,h=a.length;c<h;c++)if(!b(a[c],d[c]))return!1;return!0}}else{for(c in a)if(!b(a[c],d[c]))return!1;var i=h=0;for(c in a)h++;for(c in d)i++;return h==i}return!1}return a==d}return!1}var c=typeof localStorage=="undefined"?!1:!0;Simplr.Core.Util={mEmpty:function(a){var c=typeof a;if(c!="undefined"&&a!=null){if(c=="object"){if(e.isArray(a))return a.length==0;return e.isEmptyObject(a)}return e.trim(a)== ""}return!0},mEqual:function(a){if(!Simplr.Core.Util.mEmpty(a)&&e.isArray(a)){for(var c=!0,g=0,h=a.length;g<h;g++)b(a[0],a[g])||(c=!1,g=h);return c}return!0},mGetUrlParameter:function(c){var d=window.location.search;if(Simplr.Core.Util.mEmpty(d))return null;else{for(var b={},d=d.substring(1).split("&"),h=0,i=d.length;h<i;h++){var j=d[h].split("=");b[j[0]]=e.trim(a(decodeURIComponent(j[1])))}return Simplr.Core.Util.mEmpty(c)?b:(c=b[c],typeof c=="undefined"?null:c)}},mHasLocalStorage:function(){return c}}})(); (function(){var a={};Simplr.Core.Ui={mElementInfo:function(a){var a=e.extend({selector:"body"},a),c=e(a.selector).eq(0),a=[c.width(),c.height()],c=c.offset(),c=[c.left,c.top];return{offsets:c,dimensions:a}},mWindowInfo:function(){var a={offsets:[0,0],dimensions:[0,0]};if(typeof window.pageYOffset=="number")a.offsets=[window.pageXOffset,window.pageYOffset];else if(document.body&&(document.body.scrollLeft||document.body.scrollTop))a.offsets=[document.body.scrollLeft,document.body.scrollTop];else if(document.documentElement&& (document.documentElement.scrollLeft||document.documentElement.scrollTop))a.offsets=[document.documentElement.scrollLeft,document.documentElement.scrollTop];if(typeof window.innerWidth=="number")a.dimensions=[window.innerWidth,window.innerHeight];else if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight))a.dimensions=[document.documentElement.clientWidth,document.documentElement.clientHeight];return a},Widget:{mGenerateWidgetID:function(){var b= Math.floor(Math.random()*1E7);return Simplr.Core.Util.mEmpty(a[b])?(a[b]=!0,b):Simplr.Core.Ui.Widget.mGenerateWidgetID()}}}})();(function(a){function b(a,c){var b=c,e;for(e in a)b=b.replace(RegExp("\\$\\["+e+"\\]","g"),escape(a[e]));return unescape(b)}var c={codes:{eEmpty:"$[label] is empty.",eMissingValidator:"Missing Validator"},codeResultsTemplate:{success:[],error:[]},defaultCodeMessage:"$[label] is UNDEFINED",ruleResultsTemplate:{valid:!0,successCodes:[],errorCodes:[]},validators:{missingvalidator:function(){return a.extend(!0, {},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:!1,errorCodes:["eMissingValidator"]})},notempty:function(c){var d=a.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate());if(typeof c!="undefined"&&c!=null)if(typeof c=="string")d.valid=a.trim(c)!="";else if(a.isArray(c))d.valid=c.length!=0;else if(typeof c=="object")d.valid=!a.isEmptyObject(c);d.valid||d.errorCodes.push("eEmpty");return d}},validationResultsTemplate:{data:"",valid:!0,codes:{}}};Simplr.Core.Validation={mAddCodes:function(f){a.extend(c.codes, f)},mAddValidators:function(f){a.extend(c.validators,f)},mData:function(){return c},mGetCodeMessage:function(a,d){if(c.codes[a]!=void 0)return b({label:d},c.codes[a]);return b({label:a},c.defaultCodeMessage)},mGetRuleResultsTemplate:function(){return a.extend(!0,{},c.ruleResultsTemplate)},mValidate:function(b){var b=a.extend(!0,{},c.validationResultsTemplate,{data:a.extend(!0,{},b)}),d;for(d in b.data){var e=b.data[d];b.codes[d]=a.extend(!0,{},c.codeResultsTemplate);for(var h=0,i=e.rules.length;h< i;h++){var j=e.rules[h],l=a.extend(!0,{},c.ruleResultsTemplate),l=c.validators[j]?c.validators[j](e.value):c.validators.missingvalidator(e.value),j=d,r=b;r.codes[j].success=r.codes[j].success.concat(l.successCodes);r.codes[j].error=r.codes[j].error.concat(l.errorCodes);if(!l.valid)r.valid=!1}b.codes[d].error.length==0&&b.codes[d].success.length==0&&delete b.codes[d]}return b}}})(jQuery);Simplr.Core.Validation.mAddCodes({eMissingValidator:"Missing Validator",eAlphaNumeric:"$[label] is not alphanumeric.", eAmericanExpress:"$[label] is not a valid AMERICAN EXPRESS number.",eDinersClub:"$[label] is not a valid DINERS CLUB number.",eDiscover:"$[label] is not a valid DISCOVER number.",eEmail:"$[label] is not an email address.",eEqual:"$[label] does not match.",eMastercard:"$[label] is not a valid MASTERCARD number.",eEmpty:"$[label] is empty.",eNumber:"$[label] is not a number.",ePhoneNumber:"$[label] is not a valid Phone Number.",ePostalCode:"$[label] is not a Postal Code.",eVisa:"$[label] is not a valid VISA number."}); Simplr.Core.Validation.mAddValidators({missingvalidator:function(){return e.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:!1,errorCodes:["eMissingValidator"]})},alphanumeric:function(a){a=e.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:/^\w*$/.test(a)});a.valid||a.errorCodes.push("eAlphaNumeric");return a},americanexpress:function(a){a=e.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:/^3(4|7)\d{2}-?\d{6}-?\d{5}$/.test(a)});a.valid|| a.errorCodes.push("eAmericanExpress");return a},dinersclub:function(a){a=e.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:/^3[0,6,8]\d{12}$/.test(a)});a.valid||a.errorCodes.push("eDinersClub");return a},discover:function(a){a=e.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:/^6011-?\d{4}-?\d{4}-?\d{4}$/.test(a)});a.valid||a.errorCodes.push("eDiscover");return a},email:function(a){a=e.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/.test(a)}); a.valid||a.errorCodes.push("eEmail");return a},equal:function(a){var b=e.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate());if(e.isArray(a))for(var c=0,f=a.length;c<f;c++)if(!Simplr.Core.Util.mEqual([a[0],a[c]]))b.valid=!1,c=f;b.valid||b.errorCodes.push("eEqual");return b},mastercard:function(a){a=e.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:/^5[1-5]\d{2}-?\d{4}-?\d{4}-?\d{4}$/.test(a)});a.valid||a.errorCodes.push("eMastercard");return a},notempty:function(a){var b= e.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate());if(typeof a!="undefined"&&a!=null)if(typeof a=="string")b.valid=e.trim(a)!="";else if(e.isArray(a))b.valid=a.length!=0;else if(typeof a=="object")b.valid=!e.isEmptyObject(a);b.valid||b.errorCodes.push("eEmpty");return b},number:function(a){a=e.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:!isNaN(parseFloat(a))&&isFinite(a)});a.valid||a.errorCodes.push("eNumber");return a},phonenumber:function(a){a=e.extend(!0, {},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:/^\d{10}$/.test(a)});a.valid||a.errorCodes.push("ePhoneNumber");return a},postalcode:function(a){a=e.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:/^\d{5}([\-]?\d{4})?$/.test(a)});a.valid||a.errorCodes.push("ePostalCode");return a},visa:function(a){a=e.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:/^4\d{3}-?\d{4}-?\d{4}-?\d{4}$/.test(a)});a.valid||a.errorCodes.push("eVisa");return a}});Simplr.Form= {};(function(){var a={Classes:{FormEntry:"formEntry",FormError:"formError",FieldError:"errorField",TextError:"errorText",TextInformation:"informationText"},DefaultRules:["notempty"],DefaultLabel:"_LABEL_",Rules:{},Labels:{}};Simplr.Form={mAddValidators:function(a){Simplr.Core.Validation.mAddValidators(a)},mGetValidators:function(){return Simplr.Core.Validation.mData().validators},mAddCodes:function(a){Simplr.Core.Validation.mAddCodes(a)},mGetCodes:function(){return Simplr.Core.Validation.mData().codes}, mAddLabelAssociation:function(b){e.extend(a.Labels,b)},mAddValidationAssociation:function(b){e.extend(a.Rules,b)},mGetValues:function(a){var c={};e("input[type='checkbox']",a).each(function(){c[e(this).attr("name")]=e(this).is(":checked")?e(this).val()!="on"?e(this).val():!0:!1});e("input[type='text'], input[type='password'], input[type='hidden'], input[type='radio']:checked, select, textarea",a).each(function(){c[e(this).attr("name")]=e(this).val()});return c},mValidateValuesAndRender:function(b, c){var f={},d;for(d in c){for(var g={value:c[d],label:a.Labels[d]?a.Labels[d]:a.DefaultLabel,rules:[]},h=0,i=a.DefaultRules.length;h<i;h++)g.rules.push(a.DefaultRules[h]);try{a.Rules[d](g.rules)}catch(j){}f[d]=g}f=Simplr.Core.Validation.mValidate(f);d=a.Classes;e("."+d.FormError+",."+d.FieldError,b).filter("._simplr").removeClass(d.FormError).removeClass(d.FieldError);e("."+d.TextInformation+",."+d.TextError,b).filter("._simplr").remove();for(var l in f.codes){g=f.codes[l];g=[g.error,g.success];h= "";for(i=0;i<2;i++)g[i].length>0&&(h+='<p class="'+(i==0?d.TextError:d.TextInformation)+' _simplr">'+Simplr.Core.Validation.mGetCodeMessage(g[i][0],f.data[l].label)+"</p>");e("[name='"+l+"']:first",b).addClass(d.FieldError+" _simplr").closest("."+d.FormEntry).addClass(d.FormError+" _simplr").append(h)}return f.valid}}})();Simplr.Layout={};var s=function(a,b){typeof a=="string"&&(a=document.getElementById(a));if(a.nodeType!=1)return!1;var c=a.childNodes,f="";if(!b)for(var d=0;d<c.length;d++)if(c[d].nodeType== 3){var e=c[d].nodeValue,e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;");f+=e}else if(c[d].nodeType==8)f+="<\!--"+c[d].nodeValue+"--\>";else{f+="<"+c[d].nodeName.toLowerCase();for(var e=c[d].attributes,h=0;h<e.length;h++){var i=e[h].nodeName.toLowerCase(),j=e[h].nodeValue;i=="style"&&c[d].style.cssText?f+=' style="'+c[d].style.cssText.toLowerCase()+'"':j&&i!="contenteditable"&&(f+=" "+i+'="'+j+'"')}f+=">"+s(c[d]);f+="</"+c[d].nodeName.toLowerCase()+">"}return f};(function(){function a(c){for(;e(".layout-component", c).size()>0;)a(e(".layout-component:eq(0)",c));var b={};b[c.attr("id").split("-")[1]]=s(c.get(0));Simplr.Layout.mAddComponents(b);c.remove()}var b={Components:{},GlobalTokens:{}};Simplr.Layout={mAddComponents:function(a){for(var f in a)b.Components[f]=e.trim(a[f].replace(/\n/g,"").replace(/\s{1,}/g," "))},mAddGlobalTokens:function(a){e.extend(b.GlobalTokens,a)},mAssembleLayout:function(a){var b="";if(a&&a.component&&a.tokens)for(var d=e.isArray(a.tokens)?a.tokens:[a.tokens],g=0,h=d.length;g<h;g++){var i= {},j;for(j in d[g]){var l=i,r=j,m;m=d[g][j];m=typeof m=="object"?Simplr.Layout.mAssembleLayout(m):m;l[r]=m}b+=Simplr.Layout.mReplaceTokens(i,Simplr.Layout.mGetComponent(a.component))}return b},mData:function(){return b},mGetComponent:function(c){typeof b.Components[c]=="undefined"&&(e("#layout-"+c).size()>0?a(e("#layout-"+c)):b.Components[c]=null);return b.Components[c]},mReplaceTokens:function(a,f){if(f!=null){e.extend(a,b.GlobalTokens);for(var d in a)f=f.replace(RegExp("\\$\\["+d+"\\]","g"),escape(a[d]))}return unescape(f)}}})(); Simplr.Trigger={};(function(){function a(a){var f={services:[],data:{envID:b.Env}};e.extend(!0,f,a.options);if(Simplr.Core.Util.mEmpty(f.services)){var d=[],g;for(g in b.Services)d.push(g);f.services=d}d=e.extend(Simplr.Core.Console.mGetMessageTemplate(),{group:"simplr.trigger: "+b.Env+" environment",message:[]});g=0;for(var h=f.services.length;g<h;g++){var i=f.services[g];e.isFunction(b.Services[i][a.type])&&b.Services[i].data.environmentIDs[b.Env]&&d.message.push({message:"["+i+"] "+a.type+" triggered.", data:b.Services[i][a.type](f.data)})}d.message.length>0&&Simplr.Core.Console.mMessage(d)}var b={Env:"_simplr",Services:{}};Simplr.Trigger={mAddServices:function(c){for(var f in c)b.Services[f]=e.extend({data:{environmentIDs:{}},onLoad:function(){},onPage:function(){},onEvent:function(){},onTransaction:function(){}},c[f]),a({type:"onLoad",options:{services:[f]}})},mData:function(){return b},mSetEnvironment:function(a){b.Env=a},mOnPage:function(c){a({type:"onPage",options:e.extend({},c)})},mOnEvent:function(c){a({type:"onEvent", options:e.extend({},c)})},mOnTransaction:function(c){a({type:"onTransaction",options:e.extend({},c)})}}})();Simplr.Ui={Widget:{}};(function(){function a(a){var d=e("#"+a.id);d.size()==0?e("body").append('<div id="'+a.id+'" style="position: absolute;"></div>'):(d.removeClass(b).removeClass(c),e(a.closeSelector).unbind("click.simplr.layer.destroy."+a.id));var d=e("#"+a.id),g=!(a.xPos!=null&&a.yPos!=null);g?(a.keepCentered&&d.addClass(c),Simplr.Ui.Layer.mCenter(a.id)):d.css("left",a.xPos+"px").css("top", a.yPos+"px");d.html(a.defaultContent);g&&Simplr.Ui.Layer.mCenter(a.id);e(a.closeSelector).bind("click.simplr.layer.destroy."+a.id,function(c){c.preventDefault();Simplr.Ui.Layer.mDestroy({id:a.id,closeSelector:a.closeSelector})})}var b="_simplr_centerLayer",c="_simplr_keepCenterLayer";Simplr.Ui.Layer={mCenter:function(a){if(!Simplr.Core.Util.mEmpty(a)){var a=e("#"+a),d=a.width(),g=a.height(),h=Simplr.Core.Ui.mWindowInfo(),i=0,i=(h.dimensions[0]-d)/2,i=i<0?20:i;i+=h.offsets[0];var j=0,j=(h.dimensions[1]- g)/2,j=j<0?20:j;j+=h.offsets[1];(d>h.dimensions[0]||g>h.dimensions[1])&&a.hasClass(c)&&a.removeClass(c).addClass(b);a.css("top",j+"px").css("left",i+"px")}},mCreate:function(c){var b=e.extend({ajax:null,callback:null,closeSelector:"#_simplr_layerClose",defaultContent:"",id:"_simplr_layer",isOverlay:!1,keepCentered:!1,xPos:null,yPos:null},c);if(b.isOverlay)b.id=b.id=="_simplr_layer"?"_simplr_overlay":b.id,b.closeSelector=b.closeSelector=="#_simplr_layerClose"?"#_simplr_overlayClose":b.closeSelector, b.xPos=0,b.yPos=0;a(b);if(b.ajax!=null){var g=b.ajax.success;b.ajax.success=function(c,f){b.defaultContent=c;a(b);e.isFunction(g)&&g(c,f)};e.ajax(b.ajax)}else e.isFunction(b.callback)&&b.callback();b.isOverlay&&e("#"+b.id).css({position:"fixed",width:"100%",height:"100%"})},mDestroy:function(a){a=e.extend({id:"_simplr_layer",closeSelector:"#_simplr_layerClose"},a);Simplr.Core.Util.mEmpty(a.id)||(e("#"+a.id).remove(),e(a.closeSelector).unbind("click.simplr.ui.layer.destroy."+a.id))}};e(function(){e(window).bind("resize.simplr.ui.layer", function(){e("."+c+",."+b).each(function(a,d){e(d).addClass(c).removeClass(b);Simplr.Ui.Layer.mCenter(e(d).attr("id"))})}).bind("scroll.simplr.ui.layer",function(){e("."+c).each(function(a,b){Simplr.Ui.Layer.mCenter(e(b).attr("id"))})})})})();Simplr.Ui.mNewBrowserWindow=function(a){a=e.extend({url:"",width:500,height:500,name:"_simplr_newBrowserWindow"},a);if(!Simplr.Core.Util.mEmpty(a.url)){var b="width="+a.width+",height="+a.height,c=a.url,f=a.name;delete a.url;delete a.width;delete a.height;delete a.name; for(var d in a)b+=","+d+"="+a[d];d=window.open(c,f,b);d!=null&&d.focus()}};(function(){function a(a){this.data=e.extend({animateSpeed:200,containerSelector:"#_simplr_widget_trackableScrollingElement_container",elementSelector:"#_simplr_widget_trackableScrollingElement_element",offset:10,refreshSpeed:500,tolerance:10},a);this.data._PRIVATE={evtString:"scroll.simplr.widget.trackableScrollingElement."+Simplr.Core.Ui.Widget.mGenerateWidgetID(),timeout:null,previousOffset:0};this.destroy();var c=this; e(window).bind(c.data._PRIVATE.evtString,function(){clearTimeout(c.data._PRIVATE.timeout);c.data._PRIVATE.timeout=setTimeout(function(){var a=e(c.data.containerSelector).eq(0),b=a.children(c.data.elementSelector).eq(0);if(a.is(":visible")&&b.is(":visible")){var a=Simplr.Core.Ui.mElementInfo({selector:a}),g=Simplr.Core.Ui.mElementInfo({selector:b}),h=Simplr.Core.Ui.mWindowInfo(),i=h.offsets[1]-c.data._PRIVATE.previousOffset<0;c.data._PRIVATE.previousOffset=h.offsets[1];var j=null,l=[g.offsets[1]-c.data.tolerance, g.offsets[1]+c.data.tolerance],m=[g.offsets[1]+g.dimensions[1]-c.data.tolerance,g.offsets[1]+g.dimensions[1]+c.data.tolerance];h.dimensions[1]>g.dimensions[1]&&(h.offsets[1]<l[0]||h.offsets[1]>l[1])?j=h.offsets[1]-a.offsets[1]+c.data.offset:i&&h.offsets[1]<l[0]?j=h.offsets[1]-a.offsets[1]+c.data.offset:h.offsets[1]+g.dimensions[1]>m[1]&&(j=h.offsets[1]-a.offsets[1]-(g.dimensions[1]-h.dimensions[1])-c.data.offset);j!=null&&(j<0?j=0:j>a.dimensions[1]-g.dimensions[1]&&(j=a.dimensions[1]-g.dimensions[1]), b.stop().animate({marginTop:j},c.data.animateSpeed))}else b.css("margin-top",0)},c.data.refreshSpeed)})}Simplr.Ui.Widget.oTrackableScrollingElement=function(b){return new a(b)};a.prototype.reset=function(){e(this.data.elementSelector).eq(0).css("margin-top",0)};a.prototype.destroy=function(){this.reset();e(window).unbind(this.data._PRIVATE.evtString)}})();Simplr.Util={};Simplr.Util={mEmpty:function(a){return Simplr.Core.Util.mEmpty(a)},mEqual:function(a){return Simplr.Core.Util.mEqual(a)},mGetUrlParameter:function(a){return Simplr.Core.Util.mGetUrlParameter(a)}, mHasLocalStorage:function(){return Simplr.Core.Util.mHasLocalStorage()},mTruncateString:function(a){a=e.extend({string:"",size:5,postfix:"",smart:!0},a);if(a.string.length>a.size){var b=a.size-a.postfix.length-1,c=b+1;if(a.smart)for(;a.string.charAt(b)!=" "&&b>0;)b--;return a.string.substring(0,b==0?c:b+1)+a.postfix}return a.string}};Simplr.Validation={};Simplr.Validation={mAddCodes:function(a){Simplr.Core.Validation.mAddCodes(a)},mGetCodes:function(){return Simplr.Core.Validation.mData().codes}, mAddValidators:function(a){Simplr.Core.Validation.mAddValidators(a)},mGetValidators:function(){return Simplr.Core.Validation.mData().validators},mGetRuleResultsTemplate:function(){return Simplr.Core.Validation.mGetRuleResultsTemplate()},mGetCodeMessage:function(a,b){return Simplr.Core.Validation.mGetCodeMessage(a,b)},mValidate:function(a){return Simplr.Core.Validation.mValidate(a)}};Simplr.View={};(function(){var a={Views:{}};Simplr.View={mAddViews:function(b){for(var c in b){var f=e.extend(!0,{}, {html:function(){return""},callback:function(){}},b[c]);a.Views[c]=f}},mData:function(){return a},mRender:function(b){b=e.extend({name:"",data:"",selector:""},b);e(b.selector).html(a.Views[b.name].html(b.data));a.Views[b.name].callback(b.selector,b.data)}}})()})(jQuery);