// simplr v2.0.0
(function(d){Array.prototype.remove=function(a,b){var c=this.slice((b||a)+1||this.length);this.length=a<0?this.length+a:a;return this.push.apply(this,c)};window.Simplr={Config:{Data:{ConsoleActive:!1},mToggleConsole:function(a){d("#_simplr_core_console").remove();Simplr.Config.Data.ConsoleActive=!1;if(a)try{if(typeof window.console!="undefined"&&typeof window.console.group!="undefined")d(function(){d("body").append('<p id="_simplr_core_console" style="margin: 0; text-align: center; position: fixed; top: 0; width: 100%; left: 0; border-bottom: 1px solid #000; color: #fff; font-weight: bold; background-color: #f00; padding: 5px; font-size: 11px; opacity: .75;">[console]: Console Messaging Active</p>'); d("#_simplr_core_console").mouseover(function(){d(this).slideUp()}).mouseout(function(){d(this).delay(3E3).slideDown()})}),Simplr.Config.Data.ConsoleActive=!0}catch(b){}return Simplr.Config.Data.ConsoleActive}}};Simplr.Browser={};(function(){var a={UserAgent:""};Simplr.Browser={mAddressBarHeight:function(){var a=Simplr.Browser.mDevice();return a=="iPhone"||a=="iPod"||a=="iPad"?60:0},mDevice:function(){if(a.UserAgent.match(/iPhone/i))return"iPhone";else if(a.UserAgent.match(/iPod/i))return"iPod";else if(a.UserAgent.match(/iPad/i))return"iPad"; else if(a.UserAgent.match(/Android/i))return"Android";return"other"},mLocalStorageCapable:function(){return Simplr.Core.Util.mHasLocalStorage()},mSetUserAgent:function(b){a.UserAgent=b},mTouchCapable:function(){var a=Simplr.Browser.mDevice();return a=="iPhone"||a=="iPod"||a=="iPad"||a=="Android"}};Simplr.Browser.mSetUserAgent(navigator.userAgent)})();Simplr.Cache={};(function(){Simplr.Cache={mExpire:function(a){Simplr.Core.Util.mHasLocalStorage()&&(localStorage.removeItem(a),localStorage.removeItem(a+ "_data"));return null},mGet:function(a){a=d.extend({key:"",identifier:""},a);if(Simplr.Core.Util.mHasLocalStorage()&&a.key!=""){var b=localStorage.getItem(a.key);if(b!=null&&(b=b.split("|"),b.length==2&&b[0]==a.identifier))if((new Date).getTime()<=parseInt(b[1],10))return localStorage.getItem(a.key+"_data");else Simplr.Cache.mExpire(a.key)}return null},mSet:function(a){a=d.extend({key:"",identifier:"",data:"",freshness:6E5},a);Simplr.Core.Util.mHasLocalStorage()&&a.key!=""&&(localStorage.setItem(a.key, a.identifier+"|"+((new Date).getTime()+a.freshness)),localStorage.setItem(a.key+"_data",a.data));return a.data}}})();Simplr.Controller={};(function(a,b,c){function g(a){a=a||location.href;return"#"+a.replace(/^[^#]*#?(.*)$/,"$1")}var e="hashchange",f=document,d,i=a.event.special,j=f.documentMode,l="on"+e in b&&(j===c||j>7);a.fn[e]=function(a){return a?this.bind(e,a):this.trigger(e)};a.fn[e].delay=50;i[e]=a.extend(i[e],{setup:function(){if(l)return!1;a(d.start)},teardown:function(){if(l)return!1;a(d.stop)}}); d=function(){function d(){var c=g(),f=n(i);if(c!==i)p(i=c,f),a(b).trigger(e);else if(f!==i)location.href=location.href.replace(/#.*/,"")+f;j=setTimeout(d,a.fn[e].delay)}var h={},j,i=g(),q=function(a){return a},p=q,n=q;h.start=function(){j||d()};h.stop=function(){j&&clearTimeout(j);j=c};a.browser.msie&&!l&&function(){var c,b;h.start=function(){if(!c)b=(b=a.fn[e].src)&&b+g(),c=a('<iframe tabindex="-1" title="empty"/>').hide().one("load",function(){b||p(g());d()}).attr("src",b||"javascript:0").insertAfter("body")[0].contentWindow, f.onpropertychange=function(){try{if(event.propertyName==="title")c.document.title=f.title}catch(a){}}};h.stop=q;n=function(){return g(c.location.href)};p=function(g,b){var d=c.document,h=a.fn[e].domain;if(g!==b)d.title=f.title,d.open(),h&&d.write('<script>document.domain="'+h+'"<\/script>'),d.close(),c.location.hash=g}}();return h}()})(jQuery,this);(function(){function a(a){return a.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}var b={CRUD:{view:!0,"new":!0,update:!0,"delete":!0}, Commands:{},Bases:{}};Simplr.Controller={mAddBases:function(a){for(var a=d.isArray(a)?a:[a],g=0,e=a.length;g<e;g++)b.Bases[a[g]]=1},mAddCommands:function(a){for(var g in a){var e=d.extend({route:[],callback:function(){}},a[g]),f=e.route.join("_");if(f!="")b.Commands[f]=e.callback}},mExecute:function(a){var g=a.route.join("_");try{b.Commands[g](a)}catch(e){}},mGetCommands:function(){return b.Commands},mGetBases:function(){return b.Bases},mRoute:function(c){c={route:[],url:c,base:"",resources:{},action:"", parameters:{}};if(c.url[0]=="#")c.url=c.url.substring(1);if(c.url[0]=="!")c.url=c.url.substring(1);var g=c.url.split("?"),e=decodeURI(g[0]),f;for(f in b.Bases)if((g[0]=g[0].replace(f,""))!=e){c.base=f;c.route.push(f);break}g[0]=g[0].split("/");c.action=g[0][g[0].length-1];c.action=b.CRUD[c.action]?c.action:"view";f=!0;for(var e="",h=0,i=g[0].length-1;h<i;h++)g[0][h]!=""&&(f?(e=g[0][h],c.route.push(e),c.resources[e]=""):c.resources[e]=g[0][h],f=!f);if(g[1]){g=g[1].split("&");f=0;for(e=g.length;f<e;f++)h= g[f].split("="),c.parameters[h[0]]=d.trim(a(decodeURIComponent(h[1])))}c.route.push(c.action);return c},mRouteAndExecute:function(a){Simplr.Controller.mExecute(Simplr.Controller.mRoute(a))}};d(function(){d(window).hashchange(function(){var a=window.location.href.split("#");a.length<2&&(Simplr.Core.Util.mEmpty(a[1])||Simplr.Controller.mRouteAndExecute(a[1]))})})})();Simplr.Conversion={};var m;m||(m={});(function(){function a(a){return a<10?"0"+a:a}function b(a){e.lastIndex=0;return e.test(a)?'"'+a.replace(e, function(a){var g=i[a];return typeof g==="string"?g:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function c(a,g){var e,i,o,q,p=f,n,k=g[a];k&&typeof k==="object"&&typeof k.toJSON==="function"&&(k=k.toJSON(a));typeof j==="function"&&(k=j.call(g,a,k));switch(typeof k){case "string":return b(k);case "number":return isFinite(k)?String(k):"null";case "boolean":case "null":return String(k);case "object":if(!k)return"null";f+=d;n=[];if(Object.prototype.toString.apply(k)==="[object Array]"){q= k.length;for(e=0;e<q;e+=1)n[e]=c(e,k)||"null";o=n.length===0?"[]":f?"[\n"+f+n.join(",\n"+f)+"\n"+p+"]":"["+n.join(",")+"]";f=p;return o}if(j&&typeof j==="object"){q=j.length;for(e=0;e<q;e+=1)typeof j[e]==="string"&&(i=j[e],(o=c(i,k))&&n.push(b(i)+(f?": ":":")+o))}else for(i in k)Object.prototype.hasOwnProperty.call(k,i)&&(o=c(i,k))&&n.push(b(i)+(f?": ":":")+o);o=n.length===0?"{}":f?"{\n"+f+n.join(",\n"+f)+"\n"+p+"}":"{"+n.join(",")+"}";f=p;return o}}if(typeof Date.prototype.toJSON!=="function")Date.prototype.toJSON= function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()};var g=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g, f,d,i={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},j;if(typeof m.stringify!=="function")m.stringify=function(a,g,e){var b;d=f="";if(typeof e==="number")for(b=0;b<e;b+=1)d+=" ";else typeof e==="string"&&(d=e);if((j=g)&&typeof g!=="function"&&(typeof g!=="object"||typeof g.length!=="number"))throw Error("JSON.stringify");return c("",{"":a})};if(typeof m.parse!=="function")m.parse=function(a,c){function e(a,g){var b,d,f=a[g];if(f&&typeof f==="object")for(b in f)Object.prototype.hasOwnProperty.call(f, b)&&(d=e(f,b),d!==void 0?f[b]=d:delete f[b]);return c.call(a,g,f)}var b,a=String(a);g.lastIndex=0;g.test(a)&&(a=a.replace(g,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return b=eval("("+a+")"),typeof c==="function"?e({"":b},""):b;throw new SyntaxError("JSON.parse");}})();Simplr.Conversion= {mObjectToJSONString:function(a,b,c){return m.stringify(a,b,c)},mJSONStringToObject:function(a,b){return m.parse(a,b)}};Simplr.Cookie={};Simplr.Cookie={mGet:function(a){a=d.extend({name:""},a);if(document.cookie.length>0&&!Simplr.Core.Util.mEmpty(a.name)&&(a=document.cookie.match("(^|;) ?"+a.name+"=([^;]*)(;|$)")))return decodeURIComponent(a[2]);return null},mSet:function(a){a=d.extend({name:"",value:"",expireDays:null,path:"/",domain:null,secure:!1},a);if(!Simplr.Core.Util.mEmpty(a.name)){var b= a.name+"="+encodeURIComponent(a.value);if(!Simplr.Core.Util.mEmpty(a.expireDays)){var c=new Date;c.setTime(c.getTime()+a.expireDays*864E5);b+="; expires="+c.toUTCString()}b+=!Simplr.Core.Util.mEmpty(a.path)?"; path="+a.path:"";b+=!Simplr.Core.Util.mEmpty(a.domain)?"; domain="+a.domain:"";b+=a.secure?"; secure":"";document.cookie=b;return!0}return!1},mExpire:function(a){return Simplr.Cookie.mSet(d.extend({name:"",expireDays:-1},a))}};Simplr.Core={};(function(){function a(b){if(d.isArray(b.message)){console.group(b.group); for(var c=0,g=b.message.length;c<g;c++){var e=d.extend(Simplr.Core.Console.mGetMessageTemplate(),b.message[c]);a(e)}}else console.group(b.message),console.log(b.data);console.groupEnd()}Simplr.Core.Console={mGetMessageTemplate:function(){return{group:"",message:"",data:""}},mMessage:function(b){Simplr.Config.Data.ConsoleActive&&(b=d.extend(Simplr.Core.Console.mGetMessageTemplate(),b),a(b))}}})();(function(){function a(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g, "&quot;")}function b(a,c){if(typeof a==typeof c){if(typeof a=="object"){if(d.isArray(a)){if(a.length==c.length){for(var f=0,h=a.length;f<h;f++)if(!b(a[f],c[f]))return!1;return!0}}else{for(f in a)if(!b(a[f],c[f]))return!1;var i=h=0;for(f in a)h++;for(f in c)i++;return h==i}return!1}return a==c}return!1}var c=typeof localStorage=="undefined"?!1:!0;Simplr.Core.Util={mEmpty:function(a){var c=typeof a;if(c!="undefined"&&a!=null){if(c=="object"){if(d.isArray(a))return a.length==0;return d.isEmptyObject(a)}return d.trim(a)== ""}return!0},mEqual:function(a){if(!Simplr.Core.Util.mEmpty(a)&&d.isArray(a)){for(var c=!0,f=0,h=a.length;f<h;f++)b(a[0],a[f])||(c=!1,f=h);return c}return!0},mGetUrlParameter:function(c){var b=window.location.search;if(Simplr.Core.Util.mEmpty(b))return null;else{for(var f={},b=b.substring(1).split("&"),h=0,i=b.length;h<i;h++){var j=b[h].split("=");f[j[0]]=d.trim(a(decodeURIComponent(j[1])))}return Simplr.Core.Util.mEmpty(c)?f:(c=f[c],typeof c=="undefined"?null:c)}},mHasLocalStorage:function(){return c}}})(); (function(){var a={};Simplr.Core.Ui={mElementInfo:function(a){var a=d.extend({selector:"body"},a),c=d(a.selector).eq(0),a=[c.width(),c.height()],c=c.offset(),c=[c.left,c.top];return{offsets:c,dimensions:a}},mWindowInfo:function(){var a={offsets:[0,0],dimensions:[0,0]};if(typeof window.pageYOffset=="number")a.offsets=[window.pageXOffset,window.pageYOffset];else if(document.body&&(document.body.scrollLeft||document.body.scrollTop))a.offsets=[document.body.scrollLeft,document.body.scrollTop];else if(document.documentElement&& (document.documentElement.scrollLeft||document.documentElement.scrollTop))a.offsets=[document.documentElement.scrollLeft,document.documentElement.scrollTop];if(typeof window.innerWidth=="number")a.dimensions=[window.innerWidth,window.innerHeight];else if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight))a.dimensions=[document.documentElement.clientWidth,document.documentElement.clientHeight];return a},Widget:{mGenerateWidgetID:function(){var b= Math.floor(Math.random()*1E7);return Simplr.Core.Util.mEmpty(a[b])?(a[b]=!0,b):Simplr.Core.Ui.Widget.mGenerateWidgetID()}}}})();(function(a){function b(a,c){var b=c,d;for(d in a)b=b.replace(RegExp("\\$\\["+d+"\\]","g"),escape(a[d]));return unescape(b)}var c={codes:{eEmpty:"$[label] is empty.",eMissingValidator:"Missing Validator"},codeResultsTemplate:{success:[],error:[]},defaultCodeMessage:"$[label] is UNDEFINED",ruleResultsTemplate:{valid:!0,successCodes:[],errorCodes:[]},validators:{missingvalidator:function(){return a.extend(!0, {},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:!1,errorCodes:["eMissingValidator"]})},notempty:function(c){var b=a.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate());if(typeof c!="undefined"&&c!=null)if(typeof c=="string")b.valid=a.trim(c)!="";else if(a.isArray(c))b.valid=c.length!=0;else if(typeof c=="object")b.valid=!a.isEmptyObject(c);b.valid||b.errorCodes.push("eEmpty");return b}},validationResultsTemplate:{data:"",valid:!0,codes:{}}};Simplr.Core.Validation={mAddCodes:function(b){a.extend(c.codes, b)},mAddValidators:function(b){a.extend(c.validators,b)},mGetCodes:function(){return c.codes},mGetCodeMessage:function(a,e){if(c.codes[a]!=void 0)return b({label:e},c.codes[a]);return b({label:a},c.defaultCodeMessage)},mGetRuleResultsTemplate:function(){return a.extend(!0,{},c.ruleResultsTemplate)},mGetValidators:function(){return c.validators},mValidate:function(b){var b=a.extend(!0,{},c.validationResultsTemplate,{data:a.extend(!0,{},b)}),e;for(e in b.data){var d=b.data[e];b.codes[e]=a.extend(!0, {},c.codeResultsTemplate);for(var h=0,i=d.rules.length;h<i;h++){var j=d.rules[h],l=a.extend(!0,{},c.ruleResultsTemplate),l=c.validators[j]?c.validators[j](d.value):c.validators.missingvalidator(d.value),j=e,r=b;r.codes[j].success=r.codes[j].success.concat(l.successCodes);r.codes[j].error=r.codes[j].error.concat(l.errorCodes);if(!l.valid)r.valid=!1}b.codes[e].error.length==0&&b.codes[e].success.length==0&&delete b.codes[e]}return b}}})(jQuery);Simplr.Core.Validation.mAddCodes({eMissingValidator:"Missing Validator", eAlphaNumeric:"$[label] is not alphanumeric.",eAmericanExpress:"$[label] is not a valid AMERICAN EXPRESS number.",eDinersClub:"$[label] is not a valid DINERS CLUB number.",eDiscover:"$[label] is not a valid DISCOVER number.",eEmail:"$[label] is not an email address.",eEqual:"$[label] does not match.",eMastercard:"$[label] is not a valid MASTERCARD number.",eEmpty:"$[label] is empty.",eNumber:"$[label] is not a number.",ePhoneNumber:"$[label] is not a valid Phone Number.",ePostalCode:"$[label] is not a Postal Code.", eVisa:"$[label] is not a valid VISA number."});Simplr.Core.Validation.mAddValidators({missingvalidator:function(){return d.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:!1,errorCodes:["eMissingValidator"]})},alphanumeric:function(a){a=d.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:/^\w*$/.test(a)});a.valid||a.errorCodes.push("eAlphaNumeric");return a},americanexpress:function(a){a=d.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:/^3(4|7)\d{2}-?\d{6}-?\d{5}$/.test(a)}); a.valid||a.errorCodes.push("eAmericanExpress");return a},dinersclub:function(a){a=d.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:/^3[0,6,8]\d{12}$/.test(a)});a.valid||a.errorCodes.push("eDinersClub");return a},discover:function(a){a=d.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:/^6011-?\d{4}-?\d{4}-?\d{4}$/.test(a)});a.valid||a.errorCodes.push("eDiscover");return a},email:function(a){a=d.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(), {valid:/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/.test(a)});a.valid||a.errorCodes.push("eEmail");return a},equal:function(a){var b=d.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate());if(d.isArray(a))for(var c=0,g=a.length;c<g;c++)if(!Simplr.Core.Util.mEqual([a[0],a[c]]))b.valid=!1,c=g;b.valid||b.errorCodes.push("eEqual");return b},mastercard:function(a){a=d.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:/^5[1-5]\d{2}-?\d{4}-?\d{4}-?\d{4}$/.test(a)});a.valid|| a.errorCodes.push("eMastercard");return a},notempty:function(a){var b=d.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate());if(typeof a!="undefined"&&a!=null)if(typeof a=="string")b.valid=d.trim(a)!="";else if(d.isArray(a))b.valid=a.length!=0;else if(typeof a=="object")b.valid=!d.isEmptyObject(a);b.valid||b.errorCodes.push("eEmpty");return b},number:function(a){a=d.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:!isNaN(parseFloat(a))&&isFinite(a)});a.valid||a.errorCodes.push("eNumber"); return a},phonenumber:function(a){a=d.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:/^\d{10}$/.test(a)});a.valid||a.errorCodes.push("ePhoneNumber");return a},postalcode:function(a){a=d.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:/^\d{5}([\-]?\d{4})?$/.test(a)});a.valid||a.errorCodes.push("ePostalCode");return a},visa:function(a){a=d.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:/^4\d{3}-?\d{4}-?\d{4}-?\d{4}$/.test(a)});a.valid|| a.errorCodes.push("eVisa");return a}});Simplr.Form={};(function(){var a={Classes:{FormEntry:"formEntry",FormError:"formError",FieldError:"errorField",TextError:"errorText",TextInformation:"informationText"},DefaultRules:["notempty"],DefaultLabel:"_LABEL_",Rules:{},Labels:{}};Simplr.Form={mAddValidators:function(a){Simplr.Core.Validation.mAddValidators(a)},mGetValidators:function(){return Simplr.Core.Validation.mGetValidators()},mAddCodes:function(a){Simplr.Core.Validation.mAddCodes(a)},mGetCodes:function(){return Simplr.Core.Validation.mGetCodes()}, mAddLabelAssociation:function(b){d.extend(a.Labels,b)},mAddValidationAssociation:function(b){d.extend(a.Rules,b)},mGetValues:function(a){var c={};d("input[type='checkbox']",a).each(function(){c[d(this).attr("name")]=d(this).is(":checked")?d(this).val()!="on"?d(this).val():!0:!1});d("input[type='text'], input[type='password'], input[type='hidden'], input[type='radio']:checked, select, textarea",a).each(function(){c[d(this).attr("name")]=d(this).val()});return c},mValidateValuesAndRender:function(b, c){var g={},e;for(e in c){for(var f={value:c[e],label:a.Labels[e]?a.Labels[e]:a.DefaultLabel,rules:[]},h=0,i=a.DefaultRules.length;h<i;h++)f.rules.push(a.DefaultRules[h]);try{a.Rules[e](f.rules)}catch(j){}g[e]=f}g=Simplr.Core.Validation.mValidate(g);e=a.Classes;d("."+e.FormError+",."+e.FieldError,b).filter("._simplr").removeClass(e.FormError).removeClass(e.FieldError);d("."+e.TextInformation+",."+e.TextError,b).filter("._simplr").remove();for(var l in g.codes){f=g.codes[l];f=[f.error,f.success];h= "";for(i=0;i<2;i++)f[i].length>0&&(h+='<p class="'+(i==0?e.TextError:e.TextInformation)+' _simplr">'+Simplr.Core.Validation.mGetCodeMessage(f[i][0],g.data[l].label)+"</p>");d("[name='"+l+"']:first",b).addClass(e.FieldError+" _simplr").closest("."+e.FormEntry).addClass(e.FormError+" _simplr").append(h)}return g.valid}}})();Simplr.Layout={};var s=function(a,b){typeof a=="string"&&(a=document.getElementById(a));if(a.nodeType!=1)return!1;var c=a.childNodes,g="";if(!b)for(var e=0;e<c.length;e++)if(c[e].nodeType== 3){var d=c[e].nodeValue,d=d.replace(/</g,"&lt;"),d=d.replace(/>/g,"&gt;");g+=d}else if(c[e].nodeType==8)g+="<\!--"+c[e].nodeValue+"--\>";else{g+="<"+c[e].nodeName.toLowerCase();for(var d=c[e].attributes,h=0;h<d.length;h++){var i=d[h].nodeName.toLowerCase(),j=d[h].nodeValue;i=="style"&&c[e].style.cssText?g+=' style="'+c[e].style.cssText.toLowerCase()+'"':j&&i!="contenteditable"&&(g+=" "+i+'="'+j+'"')}g+=">"+s(c[e]);g+="</"+c[e].nodeName.toLowerCase()+">"}return g};(function(){function a(c){for(;d(".layout-component", c).size()>0;)a(d(".layout-component:eq(0)",c));var b={};b[c.attr("id").split("-")[1]]=s(c.get(0));Simplr.Layout.mAddComponents(b);c.remove()}var b={Components:{},GlobalTokens:{}};Simplr.Layout={mAddComponents:function(a){for(var g in a)b.Components[g]=d.trim(a[g].replace(/\n/g,"").replace(/\s{1,}/g," "))},mAssembleLayout:function(a){var b="";if(a&&a.component&&a.tokens)for(var e=d.isArray(a.tokens)?a.tokens:[a.tokens],f=0,h=e.length;f<h;f++){var i={},j;for(j in e[f]){var l=i,r=j,m;m=e[f][j];m=typeof m== "object"?Simplr.Layout.mAssembleLayout(m):m;l[r]=m}b+=Simplr.Layout.mReplaceTokens(i,Simplr.Layout.mGetComponent(a.component))}return b},mGetComponent:function(c){typeof b.Components[c]=="undefined"&&(d("#layout-"+c).size()>0?a(d("#layout-"+c)):b.Components[c]=null);return b.Components[c]},mGetComponents:function(){return b.Components},mAddGlobalTokens:function(a){d.extend(b.GlobalTokens,a)},mReplaceTokens:function(a,g){if(g!=null){d.extend(a,b.GlobalTokens);for(var e in a)g=g.replace(RegExp("\\$\\["+ e+"\\]","g"),escape(a[e]))}return unescape(g)}}})();Simplr.Trigger={};(function(){function a(a){var g={services:[],data:{envID:b.Env}};d.extend(!0,g,a.options);if(Simplr.Core.Util.mEmpty(g.services)){var e=[],f;for(f in b.Services)e.push(f);g.services=e}e=d.extend(Simplr.Core.Console.mGetMessageTemplate(),{group:"simplr.trigger: "+b.Env+" environment",message:[]});f=0;for(var h=g.services.length;f<h;f++){var i=g.services[f];d.isFunction(b.Services[i][a.type])&&b.Services[i].data.environmentIDs[b.Env]&& e.message.push({message:"["+i+"] "+a.type+" triggered.",data:b.Services[i][a.type](g.data)})}e.message.length>0&&Simplr.Core.Console.mMessage(e)}var b={Env:"_simplr",Services:{}};Simplr.Trigger={mAddServices:function(c){for(var g in c)b.Services[g]=d.extend({data:{environmentIDs:{}},onLoad:function(){},onPage:function(){},onEvent:function(){},onTransaction:function(){}},c[g]),a({type:"onLoad",options:{services:[g]}})},mGetServices:function(){return b.Services},mSetEnvironment:function(a){b.Env=a}, mOnPage:function(b){a({type:"onPage",options:d.extend({},b)})},mOnEvent:function(b){a({type:"onEvent",options:d.extend({},b)})},mOnTransaction:function(b){a({type:"onTransaction",options:d.extend({},b)})}}})();Simplr.Ui={Widget:{}};(function(){function a(a){var e=d("#"+a.id);e.size()==0?d("body").append('<div id="'+a.id+'" style="position: absolute;"></div>'):(e.removeClass(b).removeClass(c),d(a.closeSelector).unbind("click.simplr.layer.destroy."+a.id));var e=d("#"+a.id),f=!(a.xPos!=null&&a.yPos!= null);f?(a.keepCentered&&e.addClass(c),Simplr.Ui.Layer.mCenter(a.id)):e.css("left",a.xPos+"px").css("top",a.yPos+"px");e.html(a.defaultContent);f&&Simplr.Ui.Layer.mCenter(a.id);d(a.closeSelector).bind("click.simplr.layer.destroy."+a.id,function(b){b.preventDefault();Simplr.Ui.Layer.mDestroy({id:a.id,closeSelector:a.closeSelector})})}var b="_simplr_centerLayer",c="_simplr_keepCenterLayer";Simplr.Ui.Layer={mCenter:function(a){if(!Simplr.Core.Util.mEmpty(a)){var a=d("#"+a),e=a.width(),f=a.height(),h= Simplr.Core.Ui.mWindowInfo(),i=0,i=(h.dimensions[0]-e)/2,i=i<0?20:i;i+=h.offsets[0];var j=0,j=(h.dimensions[1]-f)/2,j=j<0?20:j;j+=h.offsets[1];(e>h.dimensions[0]||f>h.dimensions[1])&&a.hasClass(c)&&a.removeClass(c).addClass(b);a.css("top",j+"px").css("left",i+"px")}},mCreate:function(b){var c=d.extend({ajax:null,callback:null,closeSelector:"#_simplr_layerClose",defaultContent:"",id:"_simplr_layer",isOverlay:!1,keepCentered:!1,xPos:null,yPos:null},b);if(c.isOverlay)c.id=c.id=="_simplr_layer"?"_simplr_overlay": c.id,c.closeSelector=c.closeSelector=="#_simplr_layerClose"?"#_simplr_overlayClose":c.closeSelector,c.xPos=0,c.yPos=0;a(c);if(c.ajax!=null){var f=c.ajax.success;c.ajax.success=function(b,g){c.defaultContent=b;a(c);d.isFunction(f)&&f(b,g)};d.ajax(c.ajax)}else d.isFunction(c.callback)&&c.callback();c.isOverlay&&d("#"+c.id).css({position:"fixed",width:"100%",height:"100%"})},mDestroy:function(a){a=d.extend({id:"_simplr_layer",closeSelector:"#_simplr_layerClose"},a);Simplr.Core.Util.mEmpty(a.id)||(d("#"+ a.id).remove(),d(a.closeSelector).unbind("click.simplr.ui.layer.destroy."+a.id))}};d(function(){d(window).bind("resize.simplr.ui.layer",function(){d("."+c+",."+b).each(function(a,e){d(e).addClass(c).removeClass(b);Simplr.Ui.Layer.mCenter(d(e).attr("id"))})}).bind("scroll.simplr.ui.layer",function(){d("."+c).each(function(a,b){Simplr.Ui.Layer.mCenter(d(b).attr("id"))})})})})();Simplr.Ui.mNewBrowserWindow=function(a){a=d.extend({url:"",width:500,height:500,name:"_simplr_newBrowserWindow"},a);if(!Simplr.Core.Util.mEmpty(a.url)){var b= "width="+a.width+",height="+a.height,c=a.url,g=a.name;delete a.url;delete a.width;delete a.height;delete a.name;for(var e in a)b+=","+e+"="+a[e];e=window.open(c,g,b);e!=null&&e.focus()}};(function(){function a(a){this.data=d.extend({animateSpeed:200,containerSelector:"#_simplr_widget_trackableScrollingElement_container",elementSelector:"#_simplr_widget_trackableScrollingElement_element",offset:10,refreshSpeed:500,tolerance:10},a);this.data._PRIVATE={evtString:"scroll.simplr.widget.trackableScrollingElement."+ Simplr.Core.Ui.Widget.mGenerateWidgetID(),timeout:null,previousOffset:0};this.destroy();var c=this;d(window).bind(c.data._PRIVATE.evtString,function(){clearTimeout(c.data._PRIVATE.timeout);c.data._PRIVATE.timeout=setTimeout(function(){var a=d(c.data.containerSelector).eq(0),b=a.children(c.data.elementSelector).eq(0);if(a.is(":visible")&&b.is(":visible")){var a=Simplr.Core.Ui.mElementInfo({selector:a}),f=Simplr.Core.Ui.mElementInfo({selector:b}),h=Simplr.Core.Ui.mWindowInfo(),i=h.offsets[1]-c.data._PRIVATE.previousOffset< 0;c.data._PRIVATE.previousOffset=h.offsets[1];var j=null,l=[f.offsets[1]-c.data.tolerance,f.offsets[1]+c.data.tolerance],m=[f.offsets[1]+f.dimensions[1]-c.data.tolerance,f.offsets[1]+f.dimensions[1]+c.data.tolerance];h.dimensions[1]>f.dimensions[1]&&(h.offsets[1]<l[0]||h.offsets[1]>l[1])?j=h.offsets[1]-a.offsets[1]+c.data.offset:i&&h.offsets[1]<l[0]?j=h.offsets[1]-a.offsets[1]+c.data.offset:h.offsets[1]+f.dimensions[1]>m[1]&&(j=h.offsets[1]-a.offsets[1]-(f.dimensions[1]-h.dimensions[1])-c.data.offset); j!=null&&(j<0?j=0:j>a.dimensions[1]-f.dimensions[1]&&(j=a.dimensions[1]-f.dimensions[1]),b.stop().animate({marginTop:j},c.data.animateSpeed))}else b.css("margin-top",0)},c.data.refreshSpeed)})}Simplr.Ui.Widget.oTrackableScrollingElement=function(b){return new a(b)};a.prototype.reset=function(){d(this.data.elementSelector).eq(0).css("margin-top",0)};a.prototype.destroy=function(){this.reset();d(window).unbind(this.data._PRIVATE.evtString)}})();Simplr.Util={};Simplr.Util={mEmpty:function(a){return Simplr.Core.Util.mEmpty(a)}, mEqual:function(a){return Simplr.Core.Util.mEqual(a)},mGetUrlParameter:function(a){return Simplr.Core.Util.mGetUrlParameter(a)},mHasLocalStorage:function(){return Simplr.Core.Util.mHasLocalStorage()},mTruncateString:function(a){a=d.extend({string:"",size:5,postfix:"",smart:!0},a);if(a.string.length>a.size){var b=a.size-a.postfix.length-1,c=b+1;if(a.smart)for(;a.string.charAt(b)!=" "&&b>0;)b--;return a.string.substring(0,b==0?c:b+1)+a.postfix}return a.string}};Simplr.Validation={};Simplr.Validation= {mAddCodes:function(a){Simplr.Core.Validation.mAddCodes(a)},mGetCodes:function(){return Simplr.Core.Validation.mGetCodes()},mAddValidators:function(a){Simplr.Core.Validation.mAddValidators(a)},mGetValidators:function(){return Simplr.Core.Validation.mGetValidators()},mGetRuleResultsTemplate:function(){return Simplr.Core.Validation.mGetRuleResultsTemplate()},mGetCodeMessage:function(a,b){return Simplr.Core.Validation.mGetCodeMessage(a,b)},mValidate:function(a){return Simplr.Core.Validation.mValidate(a)}}; Simplr.View={};(function(){var a={};Simplr.View={mAddViews:function(b){for(var c in b){var g=d.extend(!0,{},{html:function(){return""},callback:function(){}},b[c]);a[c]=g}},mGetViews:function(){return a},mRender:function(b){b=d.extend({name:"",data:"",selector:""},b);d(b.selector).html(a[b.name].html(b.data));a[b.name].callback(b.selector,b.data)}}})()})(jQuery);